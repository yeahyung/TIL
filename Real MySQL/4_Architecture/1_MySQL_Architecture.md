## MySQL Architecture
 - MySQL 서버 = MySQL 엔진 + 스토리지 엔진

### MySQL 엔진
 - SQL 문장을 분석하거나 최적화하는 등 DBMS의 두뇌에 해당하는 부분을 담당
 - 클라이언트로부터 접속 및 쿼리 요청을 처리하는 `커넥션 핸들러`와 `SQL 파서` 및 `전처리기`, 쿼리의 최적화된 실행을 위한 `옵티마이저`가 중심을 이룬다.
 
### 스토리지 엔진
 - 실제 데이터를 디스크 스토리지에 저장하거나 디스크 스토리지로부터 데이터를 읽어오는 부분을 담당

### MySQL 스레딩
 - MySQL 서버는 프로세스 기반이 아니라 `스레드 기반`으로 작동한다.
   - Foreground 스레드(=클라이언트 스레드)
     - 클라이언트 사용자가 요청하는 쿼리 문장 처리 담당
     - 데이터를 MySQL의 데이터 버퍼나 캐시로부터 가져오며, 버퍼나 캐시에 없는 경우에는 직접 디스크의 데이터나 인덱스 파일로부터 데이터를 읽어와서 작업을 처리한다.
       - InnoDB 테이블의 경우, 데이터 버퍼나 캐시까지만 Foreground 스레드가 처리하고, 나머지 버퍼로부터 디스크까지 기록하는 작업은 Background 스레드가 처리한다(읽는 것은 Foreground 스레드가 처리)
   - Background 스레드
     - `Insert Buffer`를 병합, 로그를 디스크로 기록, InnoDB 버퍼 풀의 데이터를 디스크에 기록, 데이터를 버퍼로 읽어 오기, 잠금이나 데드락을 모니터링

### 메모리 할당 및 사용 구조
#### 1. 글로벌 메모리 영역
 - MySQL 서버가 시작되면서 운영체제로부터 할당되는 메모리 공간(클라이언트 스레드 수와 무관하게 하나의 메모리 공간만 할당됨, 스레드에 의해 공유됨)
 - 대표적인 글로벌 메모리 영역
   - `테이블 캐시`, `InnoDB 버퍼 풀`, `InnoDB 어댑티브 해시 인덱스`, `InnoDB 리두 로그 버퍼`

#### 2. 로컬 메모리 영역(=세션 메로리 영역)
 - 클라이언트 스레드가 쿼리를 처리하는데 사용하는 메모리 영역
 - 각 클라이언트 스레드별로 독립적으로 할당되며 서로 공유되지 않음
 - 각 쿼리의 용도별로 필요할 때만 공간이 할당되고, 필요하지 않은 경우에는 MySQL이 메모리 공간을 할당조차도 하지 않음
 - 대표적인 로컬 메모리 영역
   - `정렬 버펴(Sort Buffer)`, `조인 버퍼`, `바이너리 로그 캐시`, `네트워크 버퍼` 

### 쿼리 실행 구조
#### 1. 쿼리 파서
 - 쿼리 파서는 사용자 요청으로 들어온 쿼리 문장을 토큰(MySQL이 인식할 수 있는 최소 단위의 어휘나 기호)으로 분리해 트리 형태의 구조로 만들어 내는 작업
 - 쿼리 문장의 기본 문법 오류는이 과정에서 발견되어 사용자에게 오류 메시지로 전달됨
 
#### 2. 전처리기
 - 파서 과정에서 만들어진 파서 트리를 기반으로 쿼리 문장에 구조적인 문제점이 있는지 확인
   - 각 토큰을 테이블 이름이나 칼럼 이름을 매핑해 해당 객체의 존재 여부와 객체의 접근 권한 등을 확인

#### 3. 옵티마이저
 - 사용자의 요청으로 들어온 쿼리 문장을 저렴한 비용으로 가장 빠르게 처리할지를 결정, DBMS의 두뇌로 매우 중요함

#### 4. 실행 엔진
 - 실행 엔진은 만들어진 계획대로 각 핸들러에게 요청해서 받은 결과를 또 다른 핸들러 요청의 입력으로 연결

#### 5. 핸들러(스토리지 엔진)
 - 실행 엔진의 요청에 따라 데이터를 디스크로부터 읽어오거나 저장하는 역할

### 쿼리 캐시
 - SQL의 실행 결과를 메모리에 캐시하고, 동일 SQL 쿼리가 실행되면 테이블을 읽지 않고 즉시 결과 반환
 - 테이블의 데이터가 변경되면 캐시에 저장된 결과도 삭제해야했음 => 동시 처리 성능 저하 유발
 - => MySQL 8.0부터 쿼리 캐시는 사라짐

### 스레드 풀
 - MySQL 커뮤니티 버전에서는 제공하지 않지만 엔터프라이즈 에디션에서는 스레드 풀 기능을 제공함
 - 원래는 클라이언트가 커넥션을 맺으면 무조건 스레드 하나를 할당했지만 스레드 풀 기능을 사용할 경우엔 스레드 풀에서 할당(하나의 스레드가 여러 커넥션을 담당할 수 있음)

### 트랜잭션 지원 메타데이터
